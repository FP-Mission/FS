<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../Autocoders/Python/schema/ISF/component_schema.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<component name="TemperatureProbes" kind="active" namespace="App">
    <comment>Component handling the FlexTrak temperature probes</comment>
       
    <import_port_type>App/FlexTrak/TemperaturePort/TemperaturePortAi.xml</import_port_type>
    <import_port_type>Svc/Sched/SchedPortAi.xml</import_port_type>

    <ports>
        <port name="internalIn" data_type="App::Temperature" kind="async_input" max_number="1">
            <comment>
                Internal temperature in °C
            </comment>
        </port>
        <port name="externalIn" data_type="App::Temperature" kind="async_input" max_number="1">
            <comment>
                External temperature in °C, provided by the DS18B20 probe
            </comment>
        </port>
        <port name="internalOut" data_type="App::Temperature" kind="output" max_number="1">
            <comment>
                Internal temperature output in °C
            </comment>
        </port>
        <port name="externalOut" data_type="App::Temperature" kind="output" max_number="1">
            <comment>
                External temperature output in °C
            </comment>
        </port>
    </ports>

    <commands>
        <command kind="async" opcode="0" mnemonic="TempProb_SetExternalHighLevel">
            <comment>
                Set internal temperature warning level
            </comment>
            <args>
                <arg name="temperature" type="I16">
                    <comment>Temperature in °C</comment>
                </arg>          
            </args>
        </command>
        <command kind="async" opcode="1" mnemonic="TempProb_SetExternalLowLevel">
            <comment>
                Set external temperature warning level
            </comment>
            <args>
                <arg name="temperature" type="I16">
                    <comment>Temperature in °C</comment>
                </arg>          
            </args>
        </command>
    </commands>

    <telemetry>
        <channel id="0" name="TempProb_ExternalHighTemperature" data_type="I16">
            <comment>
                External high temperature in °C
            </comment>
        </channel>
        <channel id="1" name="TempProb_ExternalLowTemperature" data_type="I16">
            <comment>
                External low temperature in °C
            </comment>
        </channel>
        <channel id="2" name="TempProb_ExternalTemperature" data_type="I16">
            <comment>
                temperature in °C
            </comment>
        </channel>
    </telemetry>

    <events>
        <event id="0" name="TempPro_TempSet" severity="ACTIVITY_LO" format_string="Limit temperature set to : %d" >
            <comment>
                Sent when low/high temps is set
            </comment>
            <args>
                <arg name="temperature" type="I16">
                    <comment>Temperature in °C</comment>
                </arg>          
            </args>
        </event>
        <event id="1" name="TempPro_LowExternalWarning" severity="WARNING_HI" format_string="Low external temperature: %d" >
            <comment>
                Sent when external temperature reachs low level
            </comment>
            <args>
                <arg name="temperature" type="I16">
                    <comment>Temperature in °C</comment>
                </arg>          
            </args>
        </event>
        <event id="2" name="TempPro_HighExternalWarning" severity="WARNING_HI" format_string="High external temperature: %d" >
            <comment>
                Sent when external temperature reachs low level
            </comment>
            <args>
                <arg name="temperature" type="I16">
                    <comment>Temperature in °C</comment>
                </arg>          
            </args>
        </event>
     </events>
</component>

